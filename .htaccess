# Conectica IT - Enhanced Security & Performance Configuration

# Force index.php as default instead of index.html
DirectoryIndex index.php index.html

# Enable URL Rewriting
RewriteEngine On

# ==============================================================================
# SECURITY HEADERS
# ==============================================================================

<IfModule mod_headers.c>
    # Prevent MIME type sniffing
    Header always set X-Content-Type-Options "nosniff"
    
    # Prevent clickjacking attacks
    Header always set X-Frame-Options "DENY"
    
    # Control referrer information
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # XSS Protection (legacy browsers)
    Header always set X-XSS-Protection "1; mode=block"
    
    # Content Security Policy (basic - adjust as needed)
    Header always set Content-Security-Policy "default-src 'self'; img-src 'self' data: https: blob:; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://client.crisp.chat; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://client.crisp.chat; object-src 'none';"
</IfModule>

# ==============================================================================
# PERFORMANCE OPTIMIZATION
# ==============================================================================

# Enable Gzip Compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/json
    AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

# Browser Caching
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/webp "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType font/woff2 "access plus 1 year"
    ExpiresByType application/rss+xml "access plus 1 hour"
</IfModule>

# Cache Control Headers
<IfModule mod_headers.c>
    <FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico)$">
        Header set Cache-Control "public, max-age=2592000"
    </FilesMatch>
    <FilesMatch "\.(css|js)$">
        Header set Cache-Control "public, max-age=2592000"
    </FilesMatch>
    <FilesMatch "\.(woff|woff2)$">
        Header set Cache-Control "public, max-age=31536000"
    </FilesMatch>
</IfModule>

# ==============================================================================
# FILE ACCESS CONTROL
# ==============================================================================

# Protect sensitive files and directories
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak|sql|conf)$">
    Require all denied
</FilesMatch>

# Protect sensitive directories
<IfModule mod_rewrite.c>
    RewriteRule ^(config|logs|includes)/ - [F,L]
</IfModule>

# Prevent access to hidden files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# ==============================================================================
# MIME TYPES
# ==============================================================================

<IfModule mod_mime.c>
    AddType font/woff2 .woff2
    AddType image/webp .webp
    AddType application/rss+xml .rss
    AddType application/rss+xml .xml
</IfModule>
